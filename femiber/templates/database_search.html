{% extends "layout.html" %}
{% block content %}

<div class="page-title">
    <div class="container">
        <h1>Database Search</h1>
        <!--<p>
            Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo 
            inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, 
            sed quia consequuntur magni dolores.
        </p>-->
    </div>
</div>

<div class="wrapper d-flex align-items-stretch pt-0">
    <main role="main" class="container">
        <div class="row">
            <div class="col-md-12">

<form id="filterForm" method="post" action="{{ url_for('main.update_filters') }}">
<div class="row mb-4 mt-4">
    <div class="col-lg-4 pad-0">
        <input class="form-control" type="search" name="filter_search_value" id="filter_search_value" placeholder="Free Text Search" value="{{ filter_search_value }}">
    </div>
    <div class="col">
        <!-- <h1 class="mb-4" style="text-align: center;  font-size: xx-large;">People</h1> -->
    </div>
</div>
<div class="row stickycont">
    {% if not filter_search_value %}
    <div class="col-lg-2 filter-box">
        <h3>Filter by</h3>
        <div id="accordion2" class="filterby">
            <div class="card">
                <div class="card-header" id="headingPeople">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapsePeople" aria-expanded="true" aria-controls="collapsePeople">
                            People <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapsePeople" class="collapse" aria-labelledby="headingPeople">
                    <div class="body-card">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td>
                                        {% if filter_people_value[0] == "individual" %}
                                        <input type="radio" id="people_individual" name="people" value="individual" checked>
                                        <span class="custom-radio"></span>
                                        {% else %}
                                        <input type="radio" id="people_individual" name="people" value="individual">
                                        <span class="custom-radio"></span>
                                        {% endif %}
                                        <label for="people_individual">Anon. individual</label>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        {% if filter_people_value[0] == "groups" %}
                                        <input type="radio" id="people_groups" name="people" value="groups" checked>
                                        <span class="custom-radio"></span>
                                        {% else %}
                                        <input type="radio" id="people_groups" name="people" value="groups">
                                        <span class="custom-radio"></span>
                                        {% endif %}
                                        <label for="people_groups">Anon. groups</label>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        {% if filter_people_value[0] == "name" %}
                                        <input type="radio" id="people_name" name="people" value="name" checked>
                                        <span class="custom-radio"></span>
                                        {% elif filter_people_value and filter_people_value[0] in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' %}
                                        <input type="radio" id="people_name" name="people" value="name" checked>
                                        <span class="custom-radio"></span>
                                        {% else %}
                                        <input type="radio" id="people_name" name="people" value="name">
                                        <span class="custom-radio"></span>
                                        {% endif %}
                                        <label for="people_name">Name</label>
                                    </td>
                                </tr>
                                {% if filter_people_value[0] == "name" or (filter_people_value and filter_people_value[0] in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ') %}
                                <tr class="noradiobuttons">
                                    <td>
                                        {% for letter in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' %}
                                            {% if letter not in unique_people_list %}
                                                <input type="radio" id="people_{{ letter }}" name="people" value="{{ letter }}" disabled>
                                                <label for="people_{{ letter }}" class="disabledradio">{{ letter }}</label>
                                            {% else %}
                                                {% if letter in filter_people_value %}
                                                    <input type="radio" id="people_{{ letter }}" name="people" value="{{ letter }}" checked>
                                                    <label for="people_{{ letter }}" class="checkedradio">{{ letter }}</label>
                                                {% else %}
                                                    <input type="radio" id="people_{{ letter }}" name="people" value="{{ letter }}">
                                                    <label for="people_{{ letter }}" class="activeradio">{{ letter }}</label>
                                                {% endif %}
                                            {% endif %}

                                        {% endfor %}
                                    </td>
                                </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% if unique_kinships_list %}
            <div class="card">
                <div class="card-header" id="headingKinship">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseKinship" aria-expanded="true" aria-controls="collapseKinship">
                            Consanguineal kinship <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapseKinship" class="collapse" aria-labelledby="headingKinship">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                {% for filter in unique_kinships_list %}
                                <tr>
                                    <td>
                                        {% if filter in filter_consang_kinship_value %}
                                        <input type="checkbox" id="kinship_{{ filter }}" name="kinship" value="{{ filter }}" checked>
                                        <span class="custom-checkbox checkedbox"></span>
                                        {% else %}
                                        <input type="checkbox" id="kinship_{{ filter }}" name="kinship" value="{{ filter }}" >
                                        <span class="custom-checkbox"></span>
                                        {% endif %}
                                        <label for="kinship_{{ filter }}">{{ filter }}</label>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
            {% if unique_religion_list %}
            <div class="card">
                <div class="card-header" id="headingReligion">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseReligion" aria-expanded="true" aria-controls="collapseReligion">
                            Religion <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapseReligion" class="collapse" aria-labelledby="headingReligion">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                {% for religion in unique_religion_list %}
                                <tr>
                                    <td>
                                        {% if religion in filter_religion_value %}
                                        <input type="checkbox" id="religion_{{ religion }}" name="religion" value="{{ religion }}" checked>
                                        <span class="custom-checkbox checkedbox"></span>
                                        {% else %}
                                        <input type="checkbox" id="religion_{{ religion }}" name="religion" value="{{ religion }}">
                                        <span class="custom-checkbox"></span>
                                        {% endif %}
                                        <label for="religion_{{ religion }}">{{ religion }}</label>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
            {% if unique_religion_flag_list %}
            <div class="card">
                <div class="card-header" id="headingReligionFlag">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseReligionFlag" aria-expanded="true" aria-controls="collapseReligionFlag">
                            Religion Flag <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapseReligionFlag" class="collapse" aria-labelledby="headingReligionFlag">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                {% for religion in unique_religion_flag_list %}
                                <tr>
                                    <td>
                                        {% if religion in filter_religion_flag_value %}
                                        <input type="checkbox" id="religion_flag_{{ religion }}" name="religion_flag" value="{{ religion }}" checked>
                                        <span class="custom-checkbox checkedbox"></span>
                                        {% else %}
                                        <input type="checkbox" id="religion_flag_{{ religion }}" name="religion_flag" value="{{ religion }}">
                                        <span class="custom-checkbox"></span>
                                        {% endif %}
                                        <label for="religion_flag_{{ religion }}">{{ religion }}</label>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
            {% if unique_traits_list %}
            <div class="card">
                <div class="card-header" id="headingTraits">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTraits" aria-expanded="true" aria-controls="collapseTraits">
                            Traits <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapseTraits" class="collapse" aria-labelledby="headingTraits">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                {% for trait in unique_traits_list %}
                                <tr>
                                    <td>
                                        {% if trait in filter_traits_value %}
                                        <input type="checkbox" id="trait_{{ trait }}" name="trait" value="{{ trait }}" checked>
                                        <span class="custom-checkbox checkedbox"></span>
                                        {% else %}
                                        <input type="checkbox" id="trait_{{ trait }}" name="trait" value="{{ trait }}" >
                                        <span class="custom-checkbox"></span>
                                        {% endif %}
                                        <label for="trait_{{ trait }}">{{ trait }}</label>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
            {% if unique_partnership_list %}
            <div class="card">
                <div class="card-header" id="headingPartnership">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapsePartnership" aria-expanded="true" aria-controls="collapsePartnership">
                            Partnership <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapsePartnership" class="collapse" aria-labelledby="headingPartnership">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                {% for partnership in unique_partnership_list %}
                                <tr>
                                    <td>
                                        {% if partnership in filter_partnership_value %}
                                        <input type="checkbox" id="partnership_{{ partnership }}" name="partnership" value="{{ partnership }}" checked>
                                        <span class="custom-checkbox checkedbox"></span>
                                        {% else %}
                                        <input type="checkbox" id="partnership_{{ partnership }}" name="partnership" value="{{ partnership }}">
                                        <span class="custom-checkbox"></span>
                                        {% endif %}
                                        <label for="partnership_{{ partnership }}">{{ partnership }}</label>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
            {% if unique_motherhood_list %}
            <div class="card">
                <div class="card-header" id="headingMotherhood">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseMotherhood" aria-expanded="true" aria-controls="collapseMotherhood">
                            Motherhood <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapseMotherhood" class="collapse" aria-labelledby="headingMotherhood">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                {% for motherhood in unique_motherhood_list %}
                                <tr>
                                    <td>
                                        {% if motherhood in filter_motherhood_value %}
                                        <input type="checkbox" id="mothergood_{{ motherhood }}" name="motherhood" value="{{ motherhood }}" checked>
                                        <span class="custom-checkbox checkedbox"></span>
                                        {% else %}
                                        <input type="checkbox" id="mothergood_{{ motherhood }}" name="motherhood" value="{{ motherhood }}">
                                        <span class="custom-checkbox"></span>
                                        {% endif %}
                                        <label for="mothergood_{{ motherhood }}">{{ motherhood }}</label>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
            {% if unique_violence_list %}
            <div class="card">
                <div class="card-header" id="headingViolence">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseViolence" aria-expanded="true" aria-controls="collapseViolence">
                            Physical violence <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapseViolence" class="collapse" aria-labelledby="headingViolence">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                {% for violence in unique_violence_list %}
                                <tr>
                                    <td>
                                        {% if violence in filter_physical_violence_value %}
                                        <input type="checkbox" id="violence_{{ violence }}" name="violence" value="{{ violence }}" checked>
                                        <span class="custom-checkbox checkedbox"></span>
                                        {% else %}
                                        <input type="checkbox" id="violence_{{ violence }}" name="violence" value="{{ violence }}">
                                        <span class="custom-checkbox"></span>
                                        {% endif %}
                                        <label for="violence_{{ violence }}">{{ violence }}</label>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
            {% if unique_passing_away_list %}
            <div class="card">
                <div class="card-header" id="headingPassingAway">
                    <h5 class="mb-0">
                        <span class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapsePassingAway" aria-expanded="true" aria-controls="collapsePassingAway">
                            Passing away <img src="{{ url_for('static', filename='img/arrow-up.png') }}" class="arrow">
                        </span>
                    </h5>
                </div>
                <div id="collapsePassingAway" class="collapse" aria-labelledby="headingPassingAway">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                {% for passing_away in unique_passing_away_list %}
                                <tr>
                                    <td>
                                        {% if passing_away in filter_passing_away_value %}
                                        <input type="checkbox" id="passing_away_{{ passing_away }}" name="passing_away" value="{{ passing_away }}" checked>
                                        <span class="custom-checkbox checkedbox"></span>
                                        {% else %}
                                        <input type="checkbox" id="passing_away_{{ passing_away }}" name="passing_away" value="{{ passing_away }}">
                                        <span class="custom-checkbox"></span>
                                        {% endif %}
                                        <label for="passing_away_{{ passing_away }}">{{ passing_away }}</label>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}
    <div class="col-lg-2">
        <div class="border-bottom mb-2 cccolor">
            {% if criteria_options or filter_search_value %}
                <h3>Criteria</h3>
                <a class="diamond mb-3" href="{{ url_for('main.database_search') }}" onclick="uncheckAll()">Clear criteria</a>
            {% else %}
                <h3>Criteria</h3>
            {% endif %}
            {% if filter_search_value %}
            <p><span class="criteriatitle">Search:</span> {{ filter_search_value }}</p>
            {% endif %}
            {% if filter_people_value %}
            <!-- <p><span class="criteriatitle">People:</span> <span class="criteriavalue">{{ filter_people_value[0] }}</span></p> -->
            <p><span class="criteriatitle">People:</span> <span class="criteriavalue">{{ filter_people_value[0] }} <button class="remove-filter" data-filter-type="people" data-filter-value="{{ filter_people_value[0] }}">x</button></span></p>
            {% endif %}
            {% if filter_consang_kinship_value %}
            <!-- <p><span class="criteriatitle">Consanguineal Kinship:</span> {% for item in filter_consang_kinship_value %}  <span class="criteriavalue">{{ item }}</span> <span class="crta">|</span> {% endfor %} </p> -->
            <p><span class="criteriatitle">Consanguineal Kinship:</span> {% for item in filter_consang_kinship_value %}  <span class="criteriavalue">{{ item }} <button class="remove-filter" data-filter-type="kinship" data-filter-value="{{ item }}">x</button></span> <span class="crta">|</span> {% endfor %} </p>
            {% endif %}
            {% if filter_religion_value %}
            <!-- <p><span class="criteriatitle">Religion:</span> {% for item in filter_religion_value %}  <span class="criteriavalue">{{ item }}</span> <span class="crta">|</span> {% endfor %} </p> -->
            <p><span class="criteriatitle">Religion:</span> {% for item in filter_religion_value %}  <span class="criteriavalue">{{ item }} <button class="remove-filter" data-filter-type="religion" data-filter-value="{{ item }}">x</button></span> <span class="crta">|</span> {% endfor %} </p>
            {% endif %}
            {% if filter_religion_flag_value %}
            <!-- <p><span class="criteriatitle">Religion flag:</span> {% for item in filter_religion_flag_value %}  <span class="criteriavalue">{{ item }}</span> <span class="crta">|</span> {% endfor %} </p> -->
            <p><span class="criteriatitle">Religion Flag:</span> {% for item in filter_religion_flag_value %}  <span class="criteriavalue">{{ item }} <button class="remove-filter" data-filter-type="religion_flag" data-filter-value="{{ item }}">x</button></span> <span class="crta">|</span> {% endfor %} </p>
            {% endif %}
            {% if filter_traits_value %}
            <!-- <p><span class="criteriatitle">Traits:</span> {% for item in filter_traits_value %}  <span class="criteriavalue">{{ item }}</span> <span class="crta">|</span> {% endfor %} </p> -->
            <p><span class="criteriatitle">Traits:</span> {% for item in filter_traits_value %}  <span class="criteriavalue">{{ item }} <button class="remove-filter" data-filter-type="trait" data-filter-value="{{ item }}">x</button></span> <span class="crta">|</span> {% endfor %} </p>
            {% endif %}
            {% if filter_partnership_value %}
            <!-- <p><span class="criteriatitle">Partnership:</span> {% for item in filter_partnership_value %}  <span class="criteriavalue">{{ item }}</span> <span class="crta">|</span> {% endfor %} </p> -->
            <p><span class="criteriatitle">Partnership:</span> {% for item in filter_partnership_value %}  <span class="criteriavalue">{{ item }} <button class="remove-filter" data-filter-type="partnership" data-filter-value="{{ item }}">x</button></span> <span class="crta">|</span> {% endfor %} </p>
            {% endif %}
            {% if filter_motherhood_value %}
            <!-- <p><span class="criteriatitle">Motherhood:</span> {% for item in filter_motherhood_value %}  <span class="criteriavalue">{{ item }}</span> <span class="crta">|</span> {% endfor %} </p> -->
            <p><span class="criteriatitle">Motherhood:</span> {% for item in filter_motherhood_value %}  <span class="criteriavalue">{{ item }} <button class="remove-filter" data-filter-type="motherhood" data-filter-value="{{ item }}">x</button></span> <span class="crta">|</span> {% endfor %} </p>
            {% endif %}
            {% if filter_physical_violence_value %}
            <!-- <p><span class="criteriatitle">Violence & Transgression:</span> {% for item in filter_physical_violence_value %}  <span class="criteriavalue">{{ item }}</span> <span class="crta">|</span> {% endfor %} </p> -->
            <p><span class="criteriatitle">Physical Violence:</span> {% for item in filter_physical_violence_value %}  <span class="criteriavalue">{{ item }} <button class="remove-filter" data-filter-type="violence" data-filter-value="{{ item }}">x</button></span> <span class="crta">|</span> {% endfor %} </p>
            {% endif %}
            {% if filter_passing_away_value %}
            <!-- <p><span class="criteriatitle">Death:</span> {% for item in filter_passing_away_value %}  <span class="criteriavalue">{{ item }}</span> <span class="crta">|</span> {% endfor %} </p> -->
            <p><span class="criteriatitle">Death:</span> {% for item in filter_passing_away_value %}  <span class="criteriavalue">{{ item }} <button class="remove-filter" data-filter-type="passing_away" data-filter-value="{{ item }}">x</button></span> <span class="crta">|</span> {% endfor %} </p>
            {% endif %}
            
        </div>
        <div>
            {% if criteria_options or filter_search_value %}
            <h3 class="malomanje">Results ({{ people_results|length }}/{{ nuber_of_people }})</h3>
            {% for people in people_results %}
            <span class="result-case people-input" onclick="toggleExtraClass(this)" data-people-id="{{ people.id }}">{{ people.standard_name }}</span>
            {% endfor %}
            <!-- {% for case in filtered_cases %}
            <span class="result-case case-input" onclick="toggleExtraClass(this)" data-case-id="{{ case.id }}" data-people-id="{{ case.cases_people.id }}">{{ case.cases_people.standard_name }}</span>
            {% endfor %} -->

            {% else %}
            {% endif %}

        </div>
    </div>
    <div class="col" id="no-results">
        <p>Depending on your interests, you can select one or more filters/values from the filter panel on the left or use the free-text search box. Clickable Standard names of the people whose cases contain the search element(s) will be displayed as “Results”.</p>
        <p>After selecting one of the names from the list, the filtered case(s) linked to that individual/group will be listed on the right.</p>
        <p>Within cases, it is also possible to click on other women's names. This opens a new window with their profile page and all the cases in the database related to them.</p>
        <p>Read the <a href="{{ url_for('main.database_guide') }}">Database Guide</a> for more information about the categories and their values.</p>
        <!-- <img src="{{ url_for('static', filename='img/no-result-bg.png') }}" class="d-flex mx-auto" style="max-height: 40vh;"> -->
    </div>
    {% if criteria_options or filter_search_value %}
    <div class="col" id="search-results" style="display: none;">
        {% for people in people_results %}
        <div id="people-{{ people.id }}-id" class="people-details">
            <div class="row mb-3">
                <div class="col-9">
                    <h2 class="accent-text">{{ people.standard_name.split(',', 1)[0] }}</h2>
                    <h3 class="smanjiga">{{ people.standard_name.split(',', 1)[1] }}</h3>
                </div>
                {% if people.wikidata %}
                <div class="col d-flex justify-content-end">
                    <em>Wikidata: {{ people.wikidata }}</em>
                </div>
                {% endif %}
            </div>
            <div class="row myborderbottom"> 
                <div>
                    {{ people.about }}
                </div>
                {% if people.recorded_names %}
                <div class="just-bordered">
                    <strong>Recorded names:</strong> {{ people.recorded_names }}
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
        {% for case in filtered_cases %}
        <div id="people-{{ case.person_id }}-id" class="case-details">
            <div class="row mb-2">
                <div class="{{case.cases_people.standard_name.split(',')[0]}} xyz">
                    {{ case.case_summary }}
                </div>
                <div class="case-exc">
                    {{ case.excerpt }}
                </div>
                <div class="case-ref myborderbottom pt-2">
                    Reference: {{ case.reference }}
                </div>
                <div class="case-cri">
                    {% if case.consang_kinship and case.consang_kinship|length > 2 %}
                    <div class="no-last-one">
                        <span class="diamondsm">Consanguineal Kinship</span>
                            {% set temp = case.consang_kinship.removeprefix("[").removesuffix("]") %}
                            {% set temp = temp.split(", ") %}
                            {% for item in temp %}
                                {% set item = item.removeprefix('"').removesuffix('"') %}
                                {% if item in filter_consang_kinship_value %}
                                    <strong>{{ item }};</strong>
                                {% else %}
                                    {{ item }};
                                {% endif %}
                            {% endfor %}
                    </div>
                    {% endif %}
                    {% if case.religion and case.religion|length > 2%}
                    <div class="no-last-one">
                        <span class="diamondsm">Religion</span>
                            {% set temp = case.religion.removeprefix("[").removesuffix("]") %}
                            {% set temp = temp.split(", ") %}
                            {% for item in temp %}
                                {% set item = item.removeprefix('"').removesuffix('"') %}
                                {% if item in filter_religion_value %}
                                    <strong>{{ item }};</strong>
                                {% else %}
                                    {{ item }};
                                {% endif %}
                            {% endfor %}
                    </div>
                    {% endif %}
                    {% if case.religion_flag and case.religion_flag|length > 2 %}
                    <div class="no-last-one">
                        <span class="diamondsm">Religion Flag</span>
                            {% set temp = case.religion_flag.removeprefix("[").removesuffix("]") %}
                            {% set temp = temp.split(", ") %}
                            {% for item in temp %}
                                {% set item = item.removeprefix('"').removesuffix('"') %}
                                {% if item in filter_religion_flag_value %}
                                    <strong>{{ item }};</strong>
                                {% else %}
                                    {{ item }};
                                {% endif %}
                            {% endfor %}
                    </div>
                    {% endif %}
                    {% if case.traits and case.traits|length > 2 %}
                    <div class="no-last-one">
                        <span class="diamondsm">Traits</span>
                            {% set temp = case.traits.removeprefix("[").removesuffix("]") %}
                            {% set temp = temp.split(", ") %}
                            {% for item in temp %}
                                {% set item = item.removeprefix('"').removesuffix('"') %}
                                {% if item in filter_traits_value %}
                                    <strong>{{ item }};</strong>
                                {% else %}
                                    {{ item }};
                                {% endif %}
                            {% endfor %}
                    </div>
                    {% endif %}
                    {% if case.partnership and case.partnership|length > 2 %}
                    <div class="no-last-one">
                        <span class="diamondsm">Partnership</span>
                            {% set temp = case.partnership.removeprefix("[").removesuffix("]") %}
                            {% set temp = temp.split(", ") %}
                            {% for item in temp %}
                                {% set item = item.removeprefix('"').removesuffix('"') %}
                                {% if item in filter_partnership_value %}
                                    <strong>{{ item }};</strong>
                                {% else %}
                                    {{ item }};
                                {% endif %}
                            {% endfor %}
                    </div>
                    {% endif %}
                    {% if case.motherhood and case.motherhood|length > 2 %}
                    <div class="no-last-one">
                        <span class="diamondsm">Motherhood</span>
                            {% set temp = case.motherhood.removeprefix("[").removesuffix("]") %}
                            {% set temp = temp.split(", ") %}
                            {% for item in temp %}
                                {% set item = item.removeprefix('"').removesuffix('"') %}
                                {% if item in filter_motherhood_value %}
                                    <strong>{{ item }};</strong>
                                {% else %}
                                    {{ item }};
                                {% endif %}
                            {% endfor %}
                    </div>
                    {% endif %}
                    {% if case.physical_violence and case.physical_violence|length > 2 %}
                    <div class="no-last-one">
                        <span class="diamondsm">Physical Violence</span>
                            {% set temp = case.physical_violence.removeprefix("[").removesuffix("]") %}
                            {% set temp = temp.split(", ") %}
                            {% for item in temp %}
                                {% set item = item.removeprefix('"').removesuffix('"') %}
                                {% if item in filter_physical_violence_value %}
                                    <strong>{{ item }};</strong>
                                {% else %}
                                    {{ item }};
                                {% endif %}
                            {% endfor %}
                    </div>
                    {% endif %}
                    {% if case.passing_away and case.passing_away|length > 2 %}
                    <div class="no-last-one">
                        <span class="diamondsm">Passing Away</span>
                            {% set temp = case.passing_away.removeprefix("[").removesuffix("]") %}
                            {% set temp = temp.split(", ") %}
                            {% for item in temp %}
                                {% set item = item.removeprefix('"').removesuffix('"') %}
                                {% if item in filter_passing_away_value %}
                                    <strong>{{ item }};</strong>
                                {% else %}
                                    {{ item }};
                                {% endif %}
                            {% endfor %}
                    </div>
                    {% endif %}
                    <hr>
                </div>
                {% if case.notes %}
                <div class="case-not">
                    <strong>Notes:</strong> {{ case.notes | safe}}
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
<a href="#" class="to-top diamond">
    <i class="fas fa-chevron-up"></i>
</a>
</form>

            </div>
        </div>
    </main>
</div>


{% endblock content%}

{% block scripts %}
<script>
    const toTop = document.querySelector(".to-top");
    window.addEventListener("scroll", () => {
        if (window.pageYOffset > 400) {
            toTop.classList.add("active");
        } else {
            toTop.classList.remove("active");
        }
    })
</script>
<script>
    // Postavi kursor na kraj stringa u input polju
    function setCursorToEnd(el) {
        el.focus();
        if (typeof el.selectionStart == "number") {
            el.selectionStart = el.selectionEnd = el.value.length;
        } else if (typeof el.createTextRange != "undefined") {
            el.focus();
            var range = el.createTextRange();
            range.collapse(false);
            range.select();
        }
    }

    let typingTimer;
    const doneTypingInterval = 1000; // 1 sekunda

    document.addEventListener('DOMContentLoaded', function() {
        const filterSearchInput = document.getElementById('filter_search_value');
        
        filterSearchInput.addEventListener('input', function() {
            clearTimeout(typingTimer);
            typingTimer = setTimeout(() => {
                console.log('identifikovan input u search polje');
                document.getElementById('filterForm').submit();
            }, doneTypingInterval);
        });

        filterSearchInput.addEventListener('keydown', function() {
            clearTimeout(typingTimer);
        });

        // Postavi kursor na kraj stringa u input polju prilikom učitavanja stranice
        if (filterSearchInput.value.length > 0) {
            setCursorToEnd(filterSearchInput);
        }

        var checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function () {
                document.getElementById('filterForm').submit();
            })
        });

        var radios = document.querySelectorAll('input[type="radio"]');
        radios.forEach(function(radio) {
            radio.addEventListener('change', function () {
                document.getElementById('filterForm').submit();
            })
        });
    });
</script>
<!-- <script>
    $(document).ready(function() {
        $('.case-input').click(function() {
            var caseId = $(this).data('case-id');
            console.log("kliknut je input element: " + caseId);
            $('.case-details').hide(); // sakrij sve detalje slučajeva

            // prikaži samo detalje za odabrani slučaj
            $('#case-' + caseId).show();
        });
    });
</script> -->
<script>
    $(document).ready(function() {
        $('#search-results').hide();
    })
    $(document).ready(function() {
        $('.people-input').click(function() {
            var peopleId = $(this).data('people-id');
            console.log("kliknut je input element: " + peopleId);
            $('.case-details').hide(); // sakrij sve detalje slučajeva
            $('.people-details').hide(); // sakrij sve detalje slučajeva

            // prikaži samo detalje za odabrani slučaj
            // $('#people-' + peopleId + '-id').show(); // prikaži samo element sa tačnim id-om

            $('[id^=people-' + peopleId + '-id]').show();
            $('#search-results').show();
            $('#no-results').hide();
        });
    });
</script>

<script>
    // Check local storage for checked checkboxes
    $(document).ready(function() {
        // Restore checked checkboxes
        $("input[type='checkbox']").each(function() {
            var checkboxId = $(this).attr('id');
            var checked = localStorage.getItem(checkboxId);
            if (checked !== null) {
                $(this).prop('checked', checked === 'true');
            }
        });

        // Handle checkbox change event
        $("input[type='checkbox']").change(function() {
            var checkboxId = $(this).attr('id');
            localStorage.setItem(checkboxId, $(this).prop('checked'));
        });

        // Open the toggle box if any checkbox within it is checked
        $(".collapse").each(function() {
            var $collapse = $(this);
            if ($collapse.find("input:checked").length > 0) {
                $collapse.addClass("show");
            }
        });

        // Clean up localStorage on page unload
        $(window).on('beforeunload', function() {
            localStorage.clear();
        });
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.remove-filter').forEach(button => {
            button.addEventListener('click', function() {
                const filterType = this.getAttribute('data-filter-type');
                const filterValue = this.getAttribute('data-filter-value');
                
                // Find the corresponding input element and uncheck it
                const inputElement = document.querySelector(`input[name="${filterType}"][value="${filterValue}"]`);
                if (inputElement) {
                    inputElement.checked = false;
                }
                // Optionally, you can submit the form to refresh the page with updated filters
                document.querySelector('form').submit();
            });
        });
    });
</script>
<script>
    // Get all elements with class 'xyz'
    var elements = document.getElementsByClassName('xyz');

    // Iterate over each element
    for (var i = 0; i < elements.length; i++) {
        var element = elements[i];
        var text = element.textContent;

        // Get all classes of the current element
        var classes = element.classList;
        console.log('klase: ' + classes);

        var stringToBold = ''
        // Iterate over each class
        classes.forEach(function(className) {
            // Highlight specific words based on class name
            if (className !== 'xyz') {
                stringToBold += className + ' ';
            }
        });
        stringToBold = stringToBold.trim();
        text = text.replace(new RegExp(stringToBold, 'g'), '<strong>' + stringToBold + '</strong>');

        // Update the HTML content of the element
        element.innerHTML = text;
    }
</script>

<script>
    function toggleExtraClass(element) {
        var spans = document.querySelectorAll('.result-case');
        spans.forEach(function(span) {
            span.classList.remove('clickedspan');
        });
        element.classList.add('clickedspan');
    }
</script>
<script>
    function uncheckAll() {
    var checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(function(checkbox) {
        checkbox.checked = false;
        var checkboxId = checkbox.getAttribute('id');
        localStorage.removeItem(checkboxId);
    });
}
</script>

{% endblock %}